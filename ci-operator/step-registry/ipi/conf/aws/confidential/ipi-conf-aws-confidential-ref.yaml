ref:
  as: ipi-conf-aws-confidential
  from_image:
    namespace: ocp
    name: "4.21"
    tag: upi-installer
  commands: ipi-conf-aws-confidential-commands.sh
  resources:
    requests:
      cpu: 10m
      memory: 100Mi
  env:
  - name: CONFIDENTIAL_COMPUTE
    default: "AMDEncryptedVirtualizationNestedPaging"
    documentation: |-
      Define platform.aws.defaultMachinePlatform.cpuOptions.confidentialCompute
      Allowed values are  "Disabled", "AMDEncryptedVirtualizationNestedPaging".
  - name: COMPUTE_CONFIDENTIAL_COMPUTE
    default: ""
    documentation: |-
      Define compute.platform.aws.cpuOptions.confidentialCompute
      Allowed values are  "Disabled", "AMDEncryptedVirtualizationNestedPaging".
  - name: CONTROL_PLANE_CONFIDENTIAL_COMPUTE
    default: ""
    documentation: |-
      Define controlPlane.platform.aws.cpuOptions.confidentialCompute
      Allowed values are  "Disabled", "AMDEncryptedVirtualizationNestedPaging".
  - name: CONFIDENTIAL_COMPUTE_AMI
    default: ""
    documentation: |-
      Define custom AMI for confidential compute.
  documentation: |-
    This step enables confidential compute on the machines on AWS platform.
    cpuOptions.confidentialCompute specifies whether confidential computing should be enabled for the instance,
    and, if so, which confidential computing technology to use.
    Valid values are: Disabled, AMDEncryptedVirtualizationNestedPaging and omitted.
    When set to Disabled, confidential computing will be disabled for the instance.
    When set to AMDEncryptedVirtualizationNestedPaging, AMD SEV-SNP will be used as the confidential computing technology for the instance.