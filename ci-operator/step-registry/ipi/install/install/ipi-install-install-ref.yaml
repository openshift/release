ref:
  as: ipi-install-install
  from: installer
  grace_period: 10m
  commands: ipi-install-install-commands.sh
  cli: latest
  resources:
    requests:
      cpu: 1000m
      memory: 2Gi
  credentials:
  - namespace: test-credentials
    name: loki-stage-collector-test-secret
    mount_path: /var/run/loki-secret
  - namespace: test-credentials
    name: loki-grafanacloud-secret
    mount_path: /var/run/loki-grafanacloud-secret
  - namespace: test-credentials
    name: ci-ibmcloud8
    mount_path: /var/run/vsphere8-secrets
  env:
  - name: OPENSHIFT_INSTALL_EXPERIMENTAL_DUAL_STACK
    default: "false"
    documentation: Using experimental Azure dual-stack support
  - name: OPENSHIFT_INSTALL_PRESERVE_BOOTSTRAP
    default: ""
    documentation: "Keep bootstrap resources after install. Warning: this should only be used for debugging purposes, and poses a risk to cluster stability."
  - name: OPENSHIFT_INSTALL_PROMTAIL_ON_BOOTSTRAP
    default: ""
    documentation: "Send bootstrap logs to Loki. Warning: this should only be used for debugging purposes."
  - name: SPOT_INSTANCES
    default: "false"
    documentation:  "Use AWS Spot Instances for worker nodes.  Set to 'true' to opt into spot instances.  Explicitly set to 'false' to opt out.  Leave unset for the default, which may change."
  dependencies:
  - name: "release:latest"
    env: OPENSHIFT_INSTALL_RELEASE_IMAGE_OVERRIDE
  - name: "release:latest"
    env: RELEASE_IMAGE_LATEST
  documentation: |-
    The IPI install step runs the OpenShift Installer in order to bring up an OpenShift cluster, using the provided cluster profile to choose a target IaaS platform. Anything that needs to be configured using manifests should generate them before this step and put them in the SHARED_DIR so that this step can pull in the manifests. Files with name manifest_(manifest_name).yml|yaml end up in $INSTALL_DIR/manifests, while files with name tls_(tls_asset_name).key|pub end up in $INSTALL_DIR/tls.
