ref:
  as: insights-onprem-ros-ocp-backend-e2e
  from: src
  commands: insights-onprem-ros-ocp-backend-e2e-commands.sh
  resources:
    requests:
      cpu: 100m
      memory: 200Mi
  env:
  - name: QUAY_REPO
    default: "quay.io/cloudservices/ros-ocp-backend"
    documentation: "Quay repository for the ROS OCP Backend images"
  - name: IMAGE_TAG_DEFAULT
    default: "latest"
    documentation: "Default image tag to use if not running on a PR"
  - name: MINIO_ENDPOINT
    default: "minio-proxy.cost-onprem.svc:9000"
    documentation: "MinIO S3 endpoint for storage in host:port format (set by insights-onprem-minio-deploy step)"
  - name: MINIO_PORT
    default: "9000"
    documentation: "MinIO S3 port (used by wait-for-storage init container)"
  - name: MINIO_BUCKET
    default: "ros-data"
    documentation: "MinIO bucket name for ROS data"
  - name: IMAGE_WAIT_TIMEOUT
    default: "3600"
    documentation: "Maximum time in seconds to wait for PR image to be available (default: 60 mins)"
  - name: IMAGE_POLL_INTERVAL
    default: "60"
    documentation: "Interval in seconds between image availability checks"
  - name: COST_MGMT_CHANNEL
    default: "stable"
    documentation: "OLM channel for Cost Management Operator (stable, alpha, etc.)"
  - name: COST_MGMT_SOURCE
    default: "redhat-operators"
    documentation: "CatalogSource for Cost Management Operator"
  - name: OPERATOR_INSTALL_TIMEOUT
    default: "300"
    documentation: "Maximum time in seconds to wait for Cost Management Operator to install"
  - name: SKIP_COST_MGMT_INSTALL
    default: "false"
    documentation: "Set to 'true' to skip Cost Management Operator installation"
  documentation: |-
    This step wraps the e2e-test-dataflow execution and automatically resolves
    the IMAGE_TAG based on the job type. For presubmit jobs (PRs), it constructs
    a tag from the PR number and commit SHA. For other job types, it uses the
    default tag.

