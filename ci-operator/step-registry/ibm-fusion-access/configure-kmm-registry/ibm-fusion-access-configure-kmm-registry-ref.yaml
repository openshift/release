ref:
  as: ibm-fusion-access-configure-kmm-registry
  from: cli
  commands: ibm-fusion-access-configure-kmm-registry-commands.sh
  timeout: 10m0s
  grace_period: 15s
  resources:
    requests:
      cpu: 100m
      memory: 200Mi
  env:
  - name: FA__NAMESPACE
    documentation: The namespace for IBM Fusion Access Operator
    default: "ibm-fusion-access"
  - name: FA__KMM__REGISTRY_URL
    documentation: Container registry URL for KMM to push/pull kernel module images
    default: "image-registry.openshift-image-registry.svc:5000"
  - name: FA__KMM__REGISTRY_ORG
    documentation: Registry organization/namespace for kernel module images
    default: "ibm-spectrum-scale"
  - name: FA__KMM__REGISTRY_REPO
    documentation: Repository name for GPFS kernel module images
    default: "gpfs-compat-kmod"
  documentation: |-
    Configure KMM (Kernel Module Management) registry for IBM Storage Scale kernel modules.
    
    Creates kmm-image-config ConfigMap in two namespaces:
    1. FA__NAMESPACE (default: ibm-fusion-access) - For IBM Fusion Access operator
    2. ibm-spectrum-scale-operator - For IBM Storage Scale operator (prevents broken buildgpl)
    
    By default, this step configures the OpenShift internal registry. For external
    registries (e.g., quay.io), override FA__KMM__REGISTRY_URL and FA__KMM__REGISTRY_ORG.
    
    Prerequisite: [create-namespaces](../create-namespaces/README.md) must run first.

