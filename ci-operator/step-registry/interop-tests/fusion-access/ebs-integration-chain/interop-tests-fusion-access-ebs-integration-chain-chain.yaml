chain:
  as: interop-tests-fusion-access-ebs-integration-chain
  steps:
  - ref: storage-create-aws-extra-disks
  - ref: interop-tests-fusion-access-create-local-disks
  - ref: interop-tests-fusion-access-create-ebs-filesystem
  env:
  - name: NODE_ROLE
    default: "worker"
    documentation: The role of nodes to attach EBS volumes to
  - name: EXTRA_DISKS_COUNT
    default: "3"
    documentation: Number of EBS volumes to create per worker node for IBM Storage Scale
  - name: EXTRA_DISKS_TYPE
    default: "gp3"
    documentation: EBS volume type for IBM Storage Scale storage
  - name: EXTRA_DISKS_SIZE
    default: "100"
    documentation: Size in GiB for each EBS volume
  documentation: |-
    EBS integration chain for Fusion Access testing with EBS filesystem.
    
    This chain provides the EBS-specific components for Fusion Access testing:
    - EBS volume creation: Creates and attaches 3x100GB gp3 EBS volumes per worker node
    - LocalDisk creation: Creates LocalDisk resources (for Filesystem references)
    - Filesystem creation: Creates IBM Storage Scale filesystem using LocalDisk references
    
    Note: Cluster uses /dev/disk/by-id/* device pattern for automatic discovery of
    EBS volumes. KMM registry must be configured for kernel module building (since
    Fusion Access v0.0.19+).
        
    This chain should be used after the shared deployment chain to complete
    the EBS-based Fusion Access deployment.
    
    Prerequisites:
    - Shared deployment chain must complete successfully
    - IBM Storage Scale cluster must be ready
    - AWS cluster with worker nodes (using EBS volumes for storage)
