ref:
  as: interop-tests-ibm-fusion-access-test-vm-migration
  from: cli
  commands: interop-tests-ibm-fusion-access-test-vm-migration-commands.sh
  timeout: 2h0m0s
  grace_period: 5m0s
  resources:
    requests:
      cpu: 100m
      memory: 200Mi
  documentation: |-
    Test CNV VM live migration with IBM Storage Scale shared storage.
    
    This step tests VM live migration to verify that VMs can be migrated
    between nodes while maintaining access to IBM Storage Scale shared storage.
    
    Tests implemented:
    - FA-CNV-1022: Prepare migration environment (verify 2+ worker nodes)
    - FA-CNV-1023: Execute live migration using VirtualMachineInstanceMigration
    - FA-CNV-1024: Verify migration success and shared storage accessibility
    
    Prerequisites:
    - CNV must be deployed and operational
    - IBM Storage Scale shared storage class must be configured
    - At least 2 worker nodes required for migration
    - Test namespace will be created if it doesn't exist
    
    Note: Tests will be skipped gracefully if insufficient worker nodes available.
  env:
  - name: CNV_NAMESPACE
    documentation: The namespace for CNV
    default: "openshift-cnv"
  - name: SHARED_STORAGE_CLASS
    documentation: Storage class for shared storage between CNV and IBM Fusion Access
    default: "ibm-spectrum-scale-cnv"
  - name: TEST_NAMESPACE
    documentation: Namespace for testing VM migration
    default: "cnv-migration-test"
  - name: VM_NAME
    documentation: Name of the test VM
    default: "test-migration-vm"
  - name: VM_CPU_REQUEST
    documentation: CPU request for test VM
    default: "1"
  - name: VM_MEMORY_REQUEST
    documentation: Memory request for test VM
    default: "1Gi"
  - name: VM_MIGRATION_TIMEOUT
    documentation: Timeout for VM migration operation
    default: "15m"


