workflow:
  as: openshift-e2e-aws-local-zones-byo-vpc
  steps:
    pre:
    - ref: ipi-aws-pre-local-zones-opt-in
    - chain: ipi-aws-pre-sharednetwork
    - ref: ipi-aws-pre-local-zones-csi-default
    test:
    - ref: openshift-e2e-test
    post:
    - chain: ipi-aws-post
    - ref: ipi-deprovision-aws-sharednetwork
    env:
      AWS_EDGE_POOL_ENABLED: "yes"
      EDGE_ZONE_TYPE: local-zone
      # skip storage tests due the bug on upstream on parsing the region's endpoint URL:
      # https://issues.redhat.com/browse/OCPBUGS-11609
      TEST_SKIPS: >-
        \[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Inline-volume (ext4)\] volumes should store data \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Pre-provisioned PV (default fs)\] volumes should allow exec of files on the volume \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Pre-provisioned PV (filesystem volmode)\] volumeMode should not mount / map unused volumes in a pod \[LinuxOnly\] \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Inline-volume (ext4)\] volumes should allow exec of files on the volume \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Pre-provisioned PV (ext4)\] volumes should allow exec of files on the volume \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Pre-provisioned PV (block volmode)\] volumeMode should not mount / map unused volumes in a pod \[LinuxOnly\] \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\] \|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Pre-provisioned PV (default fs)\] volumes should store data \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Inline-volume (default fs)\] volumes should allow exec of files on the volume \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Pre-provisioned PV (block volmode)\] volumes should store data \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Inline-volume (default fs)\] volumes should store data \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Pre-provisioned PV (ext4)\] volumes should store data \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Generic Ephemeral-volume (default fs) (immediate-binding)\] ephemeral should support two pods which have the same volume definition \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Generic Ephemeral-volume (default fs) (immediate-binding)\] ephemeral should create read/write inline ephemeral volume \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Pre-provisioned PV (block volmode)\] volumeMode should not mount / map unused volumes in a pod \[LinuxOnly\] \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Generic Ephemeral-volume (default fs) (immediate-binding)\] ephemeral should create read-only inline ephemeral volume \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-storage\] In-tree Volumes \[Driver: aws\] \[Testpattern: Generic Ephemeral-volume (default fs) (immediate-binding)\] ephemeral should support expansion of pvcs created for ephemeral pvcs \[Skipped:NoOptionalCapabilities\] \[Suite:openshift/conformance/parallel\] \[Suite:k8s\]\|\[sig-network\]\[Feature:tap\] should create a pod with a tap interface \[apigroup:k8s.cni.cncf.io\] \[Suite:openshift/conformance/parallel\]
  documentation: |-
    The origin E2E AWS Local Zones workflow executes the common end-to-end test suite with OVNKubernetes network
    plugin on an AWS cluster with localzone compute nodes.