chain:
  as: sandboxed-containers-operator-ipi-azure-pre
  steps:
    - chain: ipi-conf-azure
    - ref: ipi-conf-azure-custom-region
    - chain: azure-provision-service-principal-minimal-permission
    - chain: ipi-install
    - ref: ipi-azure-rbac
  env:
    - name: CUSTOM_AZURE_REGION
      default: eastus
      documentation: |-
        Request custom azure region for openshift; using eastus
        to have the required instances available
    - name: COMPUTE_NODE_REPLICAS
      default: "2"
      documentation: |-
        Specify the number of openshift worker nodes; lowering to 2 which
        should be enough for our testing
    - name: LOKI_ENABLED
      default: "false"
    - name: SPOT_INSTANCES
      default: "false"
      documentation: |-
        Allow the use cheaper azure spot-instances; disabled here to avoid
        disappearing nodes
  documentation: |-
    The sandboxed-containers-operator-ipi-azure-pre chain install a cluster
    in Azure with some customizations.
