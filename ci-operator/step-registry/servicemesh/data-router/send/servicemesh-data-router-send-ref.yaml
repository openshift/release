ref:
  as: servicemesh-data-router-send
  from_image:
    namespace: dno
    name: droute
    tag: latest
  resources:
    requests:
      cpu: 100m
      memory: 200Mi
  timeout: 0h30m0s
  commands: servicemesh-data-router-send-commands.sh
  credentials:
    - namespace: ci
      name: ossm-oidc-sa
      mount_path: /creds-data-router
  env:
  - name: TESTRUN_NAME
    default: "Istio integration test"
    documentation: |-
      Name of the test run
  - name: TESTRUN_DESCRIPTION
    default: "Istio integration test run for Istio midstream repository"
    documentation: |-
      Description of the test run
  - name: ARTIFACT_DIR
    default: "/logs/artifacts"
    documentation: |-
      Directory containing test artifacts
  - name: TEST_FILE_NAME
    default: ""
    documentation: |-
      Name of the JUnit XML test result file; the path will be $ARTIFACT_DIR/$TEST_FILE_NAME
  - name: ISTIO_VERSION
    default: "master"
    documentation: |-
      Version of Istio being tested
  - name: OSSM_VERSION
    default: "n/a"
    documentation: |-
      Version of OpenShift Service Mesh being tested
  - name: TEST_SUITE
    default: "sail-e2e-ocp"
    documentation: |-
      Name of the test suite being executed
  - name: TEST_REPO
    default: "n/a"
    documentation: |-
      Repository being tested
  - name: INSTALLATION_METHOD
    default: "n/a"
    documentation: |-
      Method used for Istio installation
  - name: EXTRA_ATTRIBUTES
    default: ""
    documentation: |-
      JSON array of additional key/value pairs for metadata, e.g. '[{"key": "k1", "value": "v1"}, {"key": "k2", "value": "v2"}]'
  documentation: |-
    Sends test results from OpenShift Service Mesh (OSSM) test suites to the OSSM Report Portal instance using the Data Router service. 
    This step requires test results in JUnit XML format and valid Data Router credentials. 
    The step creates metadata with test run information and attributes, then sends both the metadata and test results to the Report Portal for analysis and reporting.
