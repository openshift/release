#!/bin/bash

set -o nounset
set -o errexit
set -o pipefail

echo "************ image based install verify reinstall command ************"

source "${SHARED_DIR}/packet-conf.sh"

ssh "${SSHOPTS[@]}" "root@${IP}" bash - << "EOF"

# prepending each printed line with a timestamp
exec > >(awk '{ print strftime("[%Y-%m-%d %H:%M:%S]"), $0 }') 2>&1

set -xeo pipefail

cd /root/dev-scripts
source common.sh
source utils.sh
source network.sh

mkdir -p /root/ibi-cluster

# Note: this must match the kubeconfig secret in the create secrets step
# This is the kubeconfig generated during the initial install of a cluster built with all the key and cert data in the secrets in the create-secrets step
cat > /root/ibi-cluster/kubeconfig <<-EOKUBECONFIG
clusters:
- cluster:
    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURRRENDQWlpZ0F3SUJBZ0lJVTVhNWtPZ2Rlcmd3RFFZSktvWklodmNOQVFFTEJRQXdQakVTTUJBR0ExVUUKQ3hNSmIzQmxibk5vYVdaME1TZ3dKZ1lEVlFRREV4OXJkV0psTFdGd2FYTmxjblpsY2kxc2IyTmhiR2h2YzNRdApjMmxuYm1WeU1CNFhEVEkwTVRJd05URTROREEwTlZvWERUTTBNVEl3TXpFNE5EQTBOVm93UGpFU01CQUdBMVVFCkN4TUpiM0JsYm5Ob2FXWjBNU2d3SmdZRFZRUURFeDlyZFdKbExXRndhWE5sY25abGNpMXNiMk5oYkdodmMzUXQKYzJsbmJtVnlNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXp1VmozcXVjVG9UcAp2T3RhZ3BtbXJiSDZ1RGUvUkJQN0I0cFI0b0tNYjNVTjRXVVV0eWdhbDI0d1VnZlZqSFluZXJoV1RmMWRRZ2o5Ck9GOHNqeVMyZldLNXNTaFBBaDVmWkpGMjJvd1EyR3NrZHE0WEV5RWhkdW9TRlVEcDA1dWpjQmFIVFVzM2VkNVcKWXFiZ0tPSFQzNzJYcnovbzNkdjA1ZkE4TU5TdGoxd1VBbGROWitKUHYycmwvUzQySUs2ZmVPWUNaWW5oOXl5SQppOElVS0Y0WHUrWnNnWXpCSVV3MkJxSmw5Q1VHV3ZyT29NUUY2R2xITFBVZ0ZIcmRxUkN6cGNQQUpMUHlWZEFyCldMNENOSnpMeG83emZpTlc4RkdNVzdqVGZvUmtkWUZQMExDTkpQL3N3UnVNN3FzRlREREhXQ3REWEM1QnM0dXUKTWtmTXU4R3gxUUlEQVFBQm8wSXdRREFPQmdOVkhROEJBZjhFQkFNQ0FxUXdEd1lEVlIwVEFRSC9CQVV3QXdFQgovekFkQmdOVkhRNEVGZ1FVdFhDV29XRDluYVlWczIycXFUTmpsdjF5Unh3d0RRWUpLb1pJaHZjTkFRRUxCUUFECmdnRUJBRGlucitRL3BvK3ZxUFBHTmFnZ0IvMmtLVHhxSXlnWTY5L0ZRWVJqam43ZTJQNFZ4WjNRb0M3eXprM3gKR29IRG9jU3RYeDB5QitWNmxaS2RZRTlYSWhrMTB5Qk5qUXlLN0ZtNmZTc1cyR1k3LzIxK3ZwVGFKb0RJUnpNdQpReWs5bmhDd05VY3d6amFvOUh0dVdzSCt6Sk01c1Q1cEFUWmhwbFY4cHF2akI0eUZ3SlV4TzYyOVloQkRuNzJqCnNESzZJSXl6aDhrVDViT29tbEJ5OXA1dk55Y2NheWg5M2M3cWxDODFYUk1rZGc5NFVCQ1ZGeVdhNmNOc2lGNE8Kb1hsdE0vTitWYlFMVU1NbEJ0WEg5blBKeUpGbjQzSXVDeEFqdmh5T0hhc2NKMVJZUjJlZE80djE5azJ5ZnJycAplUGJMblFIMWIrYmdCWG9WWHlaWGgvN0xwams9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURURENDQWpTZ0F3SUJBZ0lJV084UklQK1FvazR3RFFZSktvWklodmNOQVFFTEJRQXdSREVTTUJBR0ExVUUKQ3hNSmIzQmxibk5vYVdaME1TNHdMQVlEVlFRREV5VnJkV0psTFdGd2FYTmxjblpsY2kxelpYSjJhV05sTFc1bApkSGR2Y21zdGMybG5ibVZ5TUI0WERUSTBNVEl3TlRFNE5EQTBObG9YRFRNME1USXdNekU0TkRBME5sb3dSREVTCk1CQUdBMVVFQ3hNSmIzQmxibk5vYVdaME1TNHdMQVlEVlFRREV5VnJkV0psTFdGd2FYTmxjblpsY2kxelpYSjIKYVdObExXNWxkSGR2Y21zdGMybG5ibVZ5TUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQwpBUUVBd3M2YUpLNmJvR3lEWktYRTBLVWltS2IxaGhvWHBCd1gvOCt3WUJjM05uUlJLZHlEd0htUXVna281UjJNClNJOVhtV3F0dVhtOHNnL1BXdFdZampoYUYvSThUZWJLT1I1N0wrMkFLVHNwTkd0SUN1WXN1eFVnSHNaY2d1OWQKWW8renM4dmhpS3V0QmI2S0dmemRURmtKVWF3cmRaRXdEV3pPZllRYzhEd1Bwb3NiamRCU1h0UFc4aGhMTDBtUgpmaS95RWhwcHpDQjgzU3ZEZmFOQ3g2dDkvQnNDU05JRXdqSHRRTmRCSWFRNG9rbExFVm5TUnFaWUJ4S2xCZVkzCkFmVnRlK3kxOTJYTDRlRjFvK091eVd6aTVGUXdJQjZOZlZFSkEwZUFHa2FCQm05Y3BmOFVkbkFpbTdyMFY1T2kKSlNSYk0xcWdFWHZyZDNmZkkyN1BiT0pRaXdJREFRQUJvMEl3UURBT0JnTlZIUThCQWY4RUJBTUNBcVF3RHdZRApWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVVpMTThUTUVKUU4yYURhbUNIb1NZKzZEZW9wY3dEUVlKCktvWklodmNOQVFFTEJRQURnZ0VCQUtZQlQvbTc0R1hsclV4V21xZVpmS0tJM2dMd0hLWWtyU0UyVWw5WXBTbVQKZHhSUFBaOG02WnpYTmViRW1PWHdLaGQxTHo2TlVjREt4UDRNYUk5T1VrVjdiQVlCc0pZZmJLR2ZMOWM4ZHpSTQpRYVErQzR6M29xVGNRUk9vcldsL21jQjIrdDJRVmtUY3d4WmRyeFk1QWVJZ29BUlEwQVlHdUNxeDVPbktFQXpnCklpbmxkMC8reVo3em0xWTFvK0VnanBvV3IweUFweHc4bnFxckRoQmJnMUNWQS9KcjZxS3NkMU04Y3RPcmVST1QKUEFMTjVQQ3lQTHFvTlh0QjhwNDdOLzZkdHFTaUdVZC8xOGhXY25XR1F2M1hweHdTdDhGYVRGbzU2STVnVDVpRwo2MkVUUUpjVWtZV0twaTB2WHVzUDU3amNBSUJOZHJycGJXdFVaSm9wU2lRPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCi0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQpNSUlETWpDQ0FocWdBd0lCQWdJSVljQ0kxenBIeElRd0RRWUpLb1pJaHZjTkFRRUxCUUF3TnpFU01CQUdBMVVFCkN4TUpiM0JsYm5Ob2FXWjBNU0V3SHdZRFZRUURFeGhyZFdKbExXRndhWE5sY25abGNpMXNZaTF6YVdkdVpYSXcKSGhjTk1qUXhNakExTVRnME1EUTFXaGNOTXpReE1qQXpNVGcwTURRMVdqQTNNUkl3RUFZRFZRUUxFd2x2Y0dWdQpjMmhwWm5ReElUQWZCZ05WQkFNVEdHdDFZbVV0WVhCcGMyVnlkbVZ5TFd4aUxYTnBaMjVsY2pDQ0FTSXdEUVlKCktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQU15Mm1aTkFXV3dJbnJwczZUMER0Um1ZR1dOcXY5cVoKVWM2blRLRzdpT3l6bXluaStXZHE4ZWpqOWlOK05LT0p4WGdTbFVGeUd2NlYreE9IbWNTNzZEOVVGYkVDTElXNApNV3Z6YTN0YmRlc3Z3SHZ5aWdORWp2ZWtNQTB1L21NZ05JTTRrV0xnSDFyWmVZNCtYNkNmeFdtZ0dsQW9WblNICllLTEprYXFwRlowNHBSTGd1UkFzSEM3eG8xUDVGbDU5cDlRUUZrWU91TjZPRnc4S3ljcFlDTVAxaTI4aEF1UzYKTW4raXFjWWlLN0JhTjNrT3VJd0N6SkR3cElnTkxUNXFwUmhQbEZ6YXRoWVV2RFM0Zk5PWUhhakFnK1VFa1NoNgpiRVhFU3IvY1N5LzJ3QjJ5Q0diclFrWUgzNkN3bUE5M2ltNitmMDF0M0MzUW5qc1FXdktIVFkwQ0F3RUFBYU5DCk1FQXdEZ1lEVlIwUEFRSC9CQVFEQWdLa01BOEdBMVVkRXdFQi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZDUmYKcVBFblZpdUJhUldVYU1VMjRHVGwxbGp1TUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFCZnBib1Y1NGtHWkczRQpZeUtkVDVVY1dONUtKeXQrbmJDWGwwTWUvRlY4Rmt1L0ZhL0ZGQmJmWlZYVTlwK05HNWtCWWFYelF2Tk8vTUJaCnVabUlUcUpJRmhlUFlwZGFWQm1FVTNZR3pkWjlvbjNFa3llaTY3U2FSMUc4NTEySzRndnM4YmQrYndobXpUZlQKb1dXcFBBM2ZueHA0aWhPK1lEaWR1K0EvTWd4cnBkYXVhek9PamFuRVpkb2lWSjErbDN5YjJvNmcvM09VQW9NVApUVHNldTdBdUJPNGNoWWs4WjV2M0tRdlpOT1cxblhKUjlEUmFzVHFNYlhDZmk5d0M2RUJEMzc0cXQyRWF4emJnCkRTZCtFVExWdWNPSXNJcytmVCtnWHF2VGNJeEhYV1hEQUEvRHNPbEVHU2pDZ3U2SnY3K1MxanV6TXg5bEJRZnYKZXRxdEZ1L0oKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQotLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJREVEQ0NBZmlnQXdJQkFnSUlaTWRHbGVncmpZNHdEUVlKS29aSWh2Y05BUUVMQlFBd0pqRWtNQ0lHQTFVRQpBd3diYVc1bmNtVnpjeTF2Y0dWeVlYUnZja0F4TnpNek5ESTBNRFEyTUI0WERUSTBNVEl3TlRFNE5EQTBOMW9YCkRUSTJNVEl3TlRFNE5EQTBOMW93SmpFa01DSUdBMVVFQXd3YmFXNW5jbVZ6Y3kxdmNHVnlZWFJ2Y2tBeE56TXoKTkRJME1EUTJNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXdiRFBrbkNpK3RNRwpZZmlJY1Q4R1UyNzZ2WnBMcVNBNEhNa1BFeWZtNWpPdGdhMTBENHJRUjBCNU5kMyswZ05acHpJS1F1VHJXdk1PCmFMQjZYTEtVWXpEQXQ0N3EyVUlwbDdYQ0I2QWxlN0xUOUdEbGs0Z1J6d3hpcFQ3RzZFU1hQaXBtL3B0aDcwNlQKVVNTK09ZSFRhMXN2S1E2NFZxZXQvbUNQU3pXMEVKVEtwRURTMUE3RXkxMkxzbC9ZbG1JSEtxRE9ZeGNrSVNEZQpOS0Y2eTB3dlQvL1N6STAwWXBHRUphVFJVakRFdTJkY3MzbFFjZlZRTitkUTN3bHRXV3BaZWpoaENGdm9PT3ZZCk9wNmJBcGJVTXJ0OUpyU1NHYmQ3Sit1L1BHOU01U0lyU2xRcURaUlh6ZDhPdTBEYWNNdUNxV3hJZlpKSnBHNk0KdmZPWU9wVDJwUUlEQVFBQm8wSXdRREFPQmdOVkhROEJBZjhFQkFNQ0FxUXdEd1lEVlIwVEFRSC9CQVV3QXdFQgovekFkQmdOVkhRNEVGZ1FVbXd1N1kzc0Vmb0trMjF6TTc5MVh6RjhzRm1rd0RRWUpLb1pJaHZjTkFRRUxCUUFECmdnRUJBSTFQbnpWeVcwVHdaZC9MbTVPcFJZKzJoWWQvb21DYi9XdlNXNVp2aUMwbENKOFV3YXQ5MXVocjMwankKaDdoa2dKN1o4dW9HUW1MbjhOdjJxOS9CdElFSzA3YUpwT1RUNXpYalpSS0ZQL0J5S2lXdTFpcTFkekJ3N3N6awpwMHUrdWQ1aDl6eWp0NnpwNE5EOUN2VGo4Q1N6SXNyb0JRMG1ieGRqZ1d1MkY0MDRLZEhObnl6OTU5aUNkbXdxClpZZk5tOFk4RmJveWhjbFEwTHJVc1hER3ByWXVhRlBBRDd0NnNYOHhCQXM4MkthVzNCYTFBV0dVYlB3YVBGL08KU0lxSHJPM0U4L3dvbThFaklkSEJLRjNoQjZFbTZuS0ZnY3Zybk1hczFLZFh2NHhGaUtPUDZvY0V4bGc5WHhGWQoreFJxZFFNdUpMTjBpR1NzL1l0WUlqZFNGd1U9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    server: https://api.ibi-cluster.mydomain.com:6443
  name: ibi-cluster
contexts:
- context:
    cluster: ibi-cluster
    user: admin
  name: admin
current-context: admin
preferences: {}
users:
- name: admin
  user:
    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURaekNDQWsrZ0F3SUJBZ0lJTHlIOG1KZENsNk13RFFZSktvWklodmNOQVFFTEJRQXdOakVTTUJBR0ExVUUKQ3hNSmIzQmxibk5vYVdaME1TQXdIZ1lEVlFRREV4ZGhaRzFwYmkxcmRXSmxZMjl1Wm1sbkxYTnBaMjVsY2pBZQpGdzB5TkRFeU1EVXhPRFF3TkRaYUZ3MHpOREV5TURNeE9EUXdORGRhTURBeEZ6QVZCZ05WQkFvVERuTjVjM1JsCmJUcHRZWE4wWlhKek1SVXdFd1lEVlFRREV3eHplWE4wWlcwNllXUnRhVzR3Z2dFaU1BMEdDU3FHU0liM0RRRUIKQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUURBcFRMZUNHYXo1ckFFR1NOSDJQeUg5ajN1MEtLSDlNeUhzTC9SU2pYVApGTFFmalpiNXI2UFhUSExCc3JIZCsrakxQN2xub1ZQd1pTdE93Z0dCOGxOTmdSY2w3WTV6NUpBNVdLUGNLdFlMCklDYnBSczEwMW9LZENrWkpiVHdkVjBtS0dyemxKRkZIemZHN25xY1IxOFZSTUNIc01VUEwySW1tUlByeDRpYloKNTRVV3ltWDFmNUhpMEJweEs3TmZoajV0dkFobGZZVGhvb2x4eDQzL3Y4M21MamhUdHhBTFpTS1NUSkgrY24wOQptTytIZTY5QStFbXhYR1BKYVJldDVHR2oxQWh1UGZYL3NTa3NHem9hZEhjM0VSMDVMakJhWVdRRmhmajZ6T3dzCjhLWmJ0SktYUHZyNWQ0K3dOOXlieU11Wld6OE9SencxN2w2MFhPMEZENlBEQWdNQkFBR2pmekI5TUE0R0ExVWQKRHdFQi93UUVBd0lGb0RBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjREFRWUlLd1lCQlFVSEF3SXdEQVlEVlIwVApBUUgvQkFJd0FEQWRCZ05WSFE0RUZnUVViTXhYZStyZGYrNS9OempjQVA0cWh6Q3ZzQ1V3SHdZRFZSMGpCQmd3CkZvQVVDelEyNmtvVzBoSmlBcVoxTllXU01zSGlCTDR3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUtoTDFhcUcKSDUxZUp5anpIc1RXRDRpQVJ3bkpTQld3ZWRnRDhtU3FSRnNtc1VXL3A4ZjVNRWZmQlRKbCtOazJvNExhc2Y0WQpFQVFVc3FFZm1zQVZ5UjhRSmtMYXcyUEw0eWZtcG9qaG5TVGZJaVEzQ0JmTkdqNDVGR0Q5K0ZDVU80b1htSjBHCmdlREE2OGpFSU9TZ2I3T2YvWUQ5aU4wYkZrelZrRUlrT3NybE55VW9Gb3RJeGV2ZkJOZzFVeVpaUEZRWFRseTMKYjdqWmxlU0ZWUC9VSlFKbTdXVHBka0lnUlorM1dhblp3NWxnOTVyMVNISHZwbythak4vZGpiMytPem5OOE4xZApnY0puYUJZNG1oVy92Q1dVQnR3TnJmL0RNWTRxMjZSK1FveEREY2N1SjVOb29tazJQTDhlSVd2TUlwa3k2eE1FCk14OUFua1RQRXlLVmRrVT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
    client-key-data: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBd0tVeTNnaG1zK2F3QkJralI5ajhoL1k5N3RDaWgvVE1oN0MvMFVvMTB4UzBINDJXCithK2oxMHh5d2JLeDNmdm95eis1WjZGVDhHVXJUc0lCZ2ZKVFRZRVhKZTJPYytTUU9WaWozQ3JXQ3lBbTZVYk4KZE5hQ25RcEdTVzA4SFZkSmlocTg1U1JSUjgzeHU1Nm5FZGZGVVRBaDdERkR5OWlKcGtUNjhlSW0yZWVGRnNwbAo5WCtSNHRBYWNTdXpYNFkrYmJ3SVpYMkU0YUtKY2NlTi83L041aTQ0VTdjUUMyVWlra3lSL25KOVBaanZoM3V2ClFQaEpzVnhqeVdrWHJlUmhvOVFJYmozMS83RXBMQnM2R25SM054RWRPUzR3V21Ga0JZWDQrc3pzTFBDbVc3U1MKbHo3NitYZVBzRGZjbThqTG1Wcy9Ea2M4TmU1ZXRGenRCUStqd3dJREFRQUJBb0lCQUM3VGVPdlRhdk5yclhreAppd3ZaeUhoYitHM21OTHVMVzNQWUdLZ011OHlWQ2J0cHRUcjM0SUZpeWJvZmIzQ2YzTlFhcHp4elVHM3NpWHhaClYvaDRLSnQ4TjE0MndodVZnU0VQVkxVZGpHMmo0UkZ1N2wzcURsR1J2OGYxVDFscWNDdXJtQ0t5a3pjNjdmbEcKOVNFM0szVXlsK3hMaFVrMVZ6QWRNRW8vU0daS25sNWFDRnF1cGtWSWsrMGQ1N1krNC9QZEtGNDNHbHNTd0szVApPUmxzaEM3ejZzelBNRTVsbnlpdFdZR2syWXRkbFk2WUNML255Z2tJMWtSTzl1V0FpRDNJUHBScDlZd01vZkIxCnJ1cnVaWGVTNHB1U2MxS3NrTG5VUE1OYkQ0Z05qdk9pMThLZ0FlMjRnRFllWjJ3ajcvRFlpcXpyWUF1S0JxNWgKQ0tQUmVGRUNnWUVBMW5ibC8veERwZkYrUWhRR3p6ZG1xTlp1Q01QK0F0L3NPVkVrQ0ttWVlDYWwwSlFzK093NwpSZmF1OU1EdDQ1R2ZNTWNJOG9LVjEwZ3NTL1JiWmlRK2FsNE4vQU11cjFWSVVtaWVNYzR3V1ZhT3FrWDQvNUN4CmQxNHhFRG1QVTZxV2Z3NTV0dmZzenF2dEF1Y2htUnVlbElVdFN4azhoV29oSHZ4cnVtZ2tpRjhDZ1lFQTVmU0QKRUxGcWNpbTJmWG1mbHozbnNFbXEwU0lxVzdFMjJPaWVoakdtQVRmRTdoV1VmR2RKeU5ZcTd2MTB2R0ZUc1I4TAphbTY3UUp5aGgwOURzOWdsRmc3bTI3YnZYR3k2a3B1ajNrZSt5b0UwL0xyQWVUOHg4Vjg1akVyM1NqcVl4NGtjCmRtdUwwdzJDbkwvYVMvSGpnU1o5N1M4bXVhUlUrYVU5clE0VmJ4MENnWUFMMkoxenVsZHlQeGllUmNUcWhVRGkKYXBYQlhqSVZycEM1eWNXWHhPWnB5VGkzZ0xmTE9DRStDQlk1NXI0OUo3b0hVN2NtemhmQXdIZlI2amx5TnVaTApzYzVMOFZFTzFrTWNhakx5eFZUZVdtMmU4aWFDMTFjMkpMbkpENlRmRmpraDQ0Yk5tSHc0SGo4RlBnY1pFZkY4CmVxNjV5emNRbDRBazJnU0pVMTlST1FLQmdRQ2ZiYmVVMGp4bnJDM2VybjBNQVpwcGFabXBaeE9SQUx0ekJVd3EKNDY4aE53WXN2djkwaExQdUx6WVMvZHg2WXN3QWgvS0ZOd0pTR0lZUTVzNmNtS1dWdG4wdUpaV3NNYUhrMVUxMgpaYTJNZnFvNjhrdFJoSlBlc2RPWFJiNVBVM0xySEUrRWRxbTVpS3RlZTlFZ1NETWdMb3l0N2J2ZWgyVjJzNjZnCkZaeWNyUUtCZ1FEUklQTi92MXQxSENFVGdSbDZwZUJ5WFhEMUlyb1VLWDZrejcxcWNWTU5sL1hYdFNJWDZrd3kKZXFnYUczWURYeGxzWWwzejk0aDAyNStMUE5Rdnl4S3E3bFdiUHNadS9GQzBtUE1UUlgwMzlhZDZscFdTSk51NwpVUFNRcWM1aUd0bmswcjdZRmpQeHcydGJQK01qV1JtUTB5WlFHclozck50MzdHdlpYM0JmL2c9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
EOKUBECONFIG

installed_id=$(oc --kubeconfig /root/ibi-cluster/kubeconfig get clusterversion version -ojson | jq -r .spec.clusterID)
if [[ "$installed_id" != "5060b48d-da28-4d38-a361-aa850ababe6c" ]]
then
  echo "installed cluster ID $installed_id does not match expected cluster ID 5060b48d-da28-4d38-a361-aa850ababe6c"
  return 1
fi

EOF
