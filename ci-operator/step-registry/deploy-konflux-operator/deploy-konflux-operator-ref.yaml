ref:
  as: deploy-konflux-operator
  from: tests
  timeout: 30m
  grace_period: 1m
  commands: deploy-konflux-operator-commands.sh
  resources:
    requests:
      cpu: 100m
      memory: 100Mi
  env:
  - name: KONFLUX_DEPLOY_OPERATORS
    documentation: |-
      If set to "false", the operators will not be deployed. Default is "true".
    default: "true"
  - name: KONFLUX_DEPLOY_CATALOG_SOURCE
    documentation: |-
      If set to "true", the CatalogSource will be deployed as part of operator installation process. Default is "true".
    default: "true"
  - name: KONFLUX_DEPLOY_SUBSCRIPTION
    documentation: |-
      If set to "true", the Subscription, Namespace and OperatorGroup will be deployed. Default is "true".
    default: "true"
  - name: KONFLUX_TARGET_OPERATORS
    documentation: |-
      Comma separated list of operators to install (i.e "sriov,metallb,nmstate"). Mutually exclusive with KONFLUX_TARGET_FBC_TAGS.
  - name: KONFLUX_TARGET_FBC_TAGS
    documentation: |-
      Comma separated list of FBC tags to use for the operators (i.e "ocp__4.21__metallb-rhel9-operator,ocp__4.21__ose-local-storage-rhel9-operator"). Mutually exclusive with KONFLUX_TARGET_OPERATORS.
    default: ""
  - name: DISCONNECTED
    documentation: |-
      Whether to run in disconnected mode.
    default: "false"
  - name: KONFLUX_USE_REGISTRY_PROXY
    documentation: |-
      Whether to use the registry proxy. If true, the registry proxy will be used to pull the images.
    default: "false"
  - name: KONFLUX_REGISTRY_PROXY_HOST
    documentation: |-
      The host of the registry proxy. If not set, the registry proxy will be derived from the mirror registry url.
    default: ""
  - name: KONFLUX_REGISTRY_PROXY_PORT
    documentation: |-
      The port of the registry proxy. Must be set if KONFLUX_REGISTRY_PROXY_HOST is set.
    default: ""
  - name: KONFLUX_REGISTRY_PROXY_CREDENTIALS
    documentation: |-
      The credentials of the registry proxy. If not set, the credentials will be derived from the mirror registry credentials.
    default: ""
  credentials:
  - namespace: test-credentials
    name: deploy-konflux-operator-art-image-share
    mount_path: /var/run/vault/deploy-konflux-operator-art-image-share
  - namespace: test-credentials
    name: openshift-custom-mirror-registry
    mount_path: /var/run/vault/mirror-registry
  documentation: |-
     Deploy Konflux-built operators for connected environments using
     https://github.com/ajaggapa/deploy-konflux-operator
