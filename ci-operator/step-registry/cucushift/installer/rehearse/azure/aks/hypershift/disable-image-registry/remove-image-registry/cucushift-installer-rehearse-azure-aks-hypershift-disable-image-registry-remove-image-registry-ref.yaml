ref:
  as: cucushift-installer-rehearse-azure-aks-hypershift-disable-image-registry-remove-image-registry
  from_image:
    namespace: ocp
    name: cli-jq
    tag: latest
  commands: |-
    set -exuo pipefail
    if [[ $USE_HYPERSHIFT_AZURE_CREDS == "true" ]]; then
       jq 'del(.imageRegistry)' /etc/hypershift-ci-jobs-azurecreds/managed-identities.json $SHARED_DIR/managed-identities-del-image-registry.json
    else
       jq 'del(.imageRegistry)' /etc/hypershift-aro-azurecreds/managed-identities.json $SHARED_DIR/managed-identities-del-image-registry.json
  resources:
    requests:
      cpu: 100m
      memory: 100Mi
  timeout: 45m0s
  credentials:
    - mount_path: /etc/hypershift-ci-jobs-azurecreds
      name: hypershift-ci-jobs-azurecreds
      namespace: test-credentials
    - mount_path: /etc/hypershift-aro-azurecreds
      name: hypershift-aro-azurecreds
      namespace: test-credentials
  documentation: |-
    This step is to remove the ImageRegistry key-value pair from managed-identities.json and save it in $SHARED_DIR/managed-identities-del-image-registry.json

