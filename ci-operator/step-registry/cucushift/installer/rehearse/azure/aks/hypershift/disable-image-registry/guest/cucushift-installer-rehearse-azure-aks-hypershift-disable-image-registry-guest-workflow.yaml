workflow:
  as: cucushift-installer-rehearse-azure-aks-hypershift-disable-image-registry-guest
  steps:
    pre:
      - chain: cucushift-installer-rehearse-azure-aks-hypershift-disable-image-registry-provision
      - ref: cucushift-hypershift-extended-enable-guest
    post:
      - ref: cucushift-hypershift-extended-disable-guest
      - chain: cucushift-installer-rehearse-azure-aks-hypershift-disable-image-registry-deprovision
  documentation: |-
    Create/destroy an aks management cluster and a public hosted cluster with "--disable-cluster-capabilities ImageRegistry" when create 
    Hypershift azure cluster. A managed identities file without ImageRegistry configuration will be passed to create hypershift cluster by default.
    
