workflow:
  as: cucushift-installer-rehearse-azure-hypershift-guest-advanced
  steps:
    pre:
      - chain: cucushift-installer-rehearse-azure-hypershift-provision
      - ref: cucushift-hypershift-extended-nodepool-image-azure-get-marketplace-image
      - ref: hypershift-azure-create-nodepool
      - ref: cucushift-hypershift-extended-enable-guest
      - ref: cucushift-installer-reportportal-marker
      - ref: cucushift-hypershift-extended-marketplace-validation
    post:
      - ref: cucushift-hypershift-extended-disable-guest
      - chain: cucushift-installer-rehearse-azure-hypershift-deprovision
      - ref: send-results-to-reportportal
  documentation: |-
    Installs the Hypershift Operator and creates a hosted cluster in azure cloud provider, do the test for guest cluster, then destroys hosted clsuter and mgmt cluster.
