workflow:
  as: hypershift-mce-ibmz-conformance-s390xmgmt
  documentation: |-
    The HyperShift mce ibmz conformance workflow executes tests against a new ephemeral Hypershift Agent cluster
    created on ibmz Nodes to validate the cluster creation reaches completed state.
  steps:
    pre:
      - ref: hypershift-mce-ibmz-create-s390xmgmt
      - ref: hypershift-mce-install
      - ref: hypershift-mce-ibmz-create-hcp
      - ref: hypershift-mce-ibmz-create-zvsicomputes390x
    test:
      - ref: hypershift-mce-agent-info
      - chain: hypershift-mce-ibmz-test
    post:
      - ref: hypershift-mce-ibmz-destroy-hcp
      - ref: hypershift-mce-ibmz-destroy-zvsi-computes390x
      - ref: hypershift-mce-ibmz-destroy-s390x-mgmt
    env:
      HYPERSHIFT_BASEDOMAIN: 'hcpci.com'
      HYPERSHIFT_NODE_COUNT: 2
      IC_CLI_VERSION: '2.36.0'
      ZVSI_IMAGE: 'ibm-ubuntu-22-04-5-minimal-s390x-5'
      IC_REGION: 'eu-de'
      HC_NS: 'agent-ibmz'
      CONTROL_NODE_COUNT: 3
      COMPUTE_NODE_COUNT: 3
      REGION: 'Frankfurt'
      RESOURCE_GROUP: 'hypershift'
