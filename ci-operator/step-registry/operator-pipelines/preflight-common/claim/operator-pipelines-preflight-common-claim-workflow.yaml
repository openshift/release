workflow:
  as: operator-pipelines-preflight-common-claim
  steps:
    env:
      TEST_ASSET: quay.io/opdev/simple-demo-operator-bundle:latest
      ASSET_TYPE: operator
      PFLT_INDEXIMAGE: quay.io/opdev/simple-demo-operator-catalog:latest
      PFLT_ARTIFACTS: "./artifacts"
      PFLT_DOCKERCONFIG: "LS0tLS1CRUdJTiBQR1AgTUVTU0FHRS0tLS0tCgpoUUlNQTh4aU9NSmNJNXY2QVEvL1l2Vzg3MDBnb3VDZDlXVVpIZEVVRloxVGE4dkNjVDY0S05wQ1RkUVljTEZjClI5b0NnK2lOaUh3QnFSd0ZERHArZmhseU1vVjRXU3JBTWhBMjB5NnR1VUcwV1MyU2VmcTVBRkhHdDhXZWtMOWQKVVJVSW5XR2I5RFZIYytwUUVNYktXem1UZ0RnSHJiaGJLOXFLQWozQmdMWWZ6TnBQYnRwSlZYdUpvV3dMODZxVwpsUU4vMUVHWVFpOVFjbkJUaG4rQmZHSWFoak9GQ3R1ZnF0VTJSb0Vnb3JrQmlOa0ZyVnRIMmV0VDNqQXorK3lJCnpTZnZwYWF0SW80S0hQRk1pL1Rab2F1Z0ZJZzdNRUZDaktuOW1jczdlVUZOQzRsUlRhRFRpZ3Vsa09mSWo4VjcKdmsyM2dydzVEd0hlVUhIdlVGMXN1MHNIZXpEOFM0UXhmYnFMNW5jaGpSM3BzY04rV2hGUUtSSzVzVGM3NEVFMgorQmpJSHQ4WkxiTEVOQlF3WmZFVEtxNzBIbDZoT3NoWmpPaGZqQ1VmUnRack5VRWlRWXhBZlVzN0N5ampFWE8vCkFLK1VzZ1gwZDM4U2ppb0Mwd2tLbUtNaVZhSElqMGZqMDVkdlVYUlZoRWRMVUNOdUVGTUI3L1ZBdnoyZmlBL2oKYTNCSDF1VkVlVU5tazE2eWpaOU1wa2pBZFpwTUF1WHcrQnd2UURqOGdpZzdNY0plcU1BeGxrb2FOQkV4RllYagpERmN4VzVvQ2dEb25QVy9kRzZsNVVlSnd4TmJMYk96UXB6RGFnSFFodmgra1p6ODM0TW9yaGFDZTlJNmxPMmJXCnZUYUlTVnQzalFJNE51eUMrNWJzMUdNS01weWZCemIyV2NuVW4rRjVDTFZVd2U2Sms2ek5JQUpHRm9tZUhFclMKNlFFdVo4NWlsdVdnZ0IrTStLRWtFRTlpRSthL3pWZlBzZzl6RGRsTDhjbEdvMmY0T0JJNklRS3U5cmptU3Z3KwpwY0dNWXo5SG5iM1RpQWhQMXcxMWIyNlI2dWhFOHZIcVRGaTU2bWdwenRiekN3Vm94cVYrcWZpb3AwL0hMd1lSCktIVysyTHpRRGthZ2lqYTBQckNJQU1ielZ2U0ZramhFOG5BbmRiRmFvdTFpaVRTbmlpdHU3bnNzSUZEOTN6QWwKNnJYNXFRblk2bXRKWGlVK0hyYUtiOTMxVlRsdm52Z3ZOWHo4VG80VDB2by96SWtwVm9BUXhyT1E5K3VhU0tmZQpmeHRRNElQcWNNQUR4bi9MaFBiZ0xzanZlWmUzMjZJbnp1TVdpUmR1VWQyMklOMEhTZ2JzOXY5d05lQytjeHM0CjZNUzc0NXM4UFh0K0Z3OVl3Rng2UHFHOVUxeFFxMVkzWWxXaWVVMnU0TFhmRnRyamNQeVJ5cDA0N2cvQkQ0TkgKejl2d0tIaFVGUHUzSER0WjlQZnlhcnc1ZWpYa0tCRXFTSGsyQXQ5bytJU2hsTVpuZmRzaC9Na044N0cwZGs0dwpBQnkycE1lVER0NDVNeFpVM1BXWDNHZk90RnVVZjdEZnNKZEltaHdPVFlhZXpYZUNyT1hIbVNQRjZmdHFSajUxCldXcGVTWFloamNpY1dIdDc2MmdJL05GeEhLNU15UGZLTUVOeHV1SCtRZFROU0REajFwZG56RHhHWHZMbjNiaTYKdTRaRVptaElkYmhBQ0Z2UVpQYkc5RVRYS0FTWTZSTWsxQnQwTWZyZjNGWUlxeThudEZEQlhGQW1CLzdyLzBqNgpZM1hCbDNqbVpqeWI0dU43dDBvcE5CY01hdEJRa3dOT0Q1NWljc1NrZk44UXdDOVp6c21XbytiMDJxdG5kTDdJClg1TzFwc0pidmo5ekJjMmQ2MzhEQlhJZ1RrZW84TlBDODI1YmI3UUZLdHpKRURDSU5rcjR1Zlg2TS83R1FkYkIKSjNjN3RHUVVtQWhRWGtzaTFOaWJ2ZVRjT0dieWwwTkxOeFR0SUdhK2hhRTdGZWs1WnFWQ09SWDZKOU1YY2JFbApYWWg3K0ZKa2hzNXMzREcrdWc2WFgvcDVHRmZyemJRdDNQUTdNWEdrc2dzZFZZSTBHMjVTbDFza3RaU3gzYUdECmUrUkxuV2l1VzBoSmYvMjRIV2JySWxub0tQS2s5eUFFUWIzRWpjRFVlMDRGSzgxbW5rVjJiOWZVaEcrZzBkY3kKYk01SUZKVHFEckxRS29lMHZGYk1BNkRIRExQOUFWLzJUaDdTZVNPcitaSjd0Zz09Cj1aUjdSCi0tLS0tRU5EIFBH"
    pre:
    - ref: ipi-install-rbac
    test:
    - ref: operator-pipelines-preflight-common-decrypt
    - ref: operator-pipelines-preflight-common-check
    - ref: operator-pipelines-preflight-common-encrypt
    post:
    - chain: gather
  documentation: |-
    This workflows perform shared pre/post actions on clusters obtained from
    preinstalled pools (https://docs.ci.openshift.org/docs/architecture/ci-operator/#testing-with-a-cluster-from-a-cluster-pool).
    Claims a cluster with a default configuration on AWS and executes the Preflight
    tool against a provided asset.
    Important: Parameter values in `env` are supposed to be used only in rehearsals
    and serve as "testing defaults". Production jobs should always override them
    via `preflight-trigger`.
