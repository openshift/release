workflow:
  as: operator-pipelines-preflight-common-claim
  steps:
    env:
      TEST_ASSET: quay.io/opdev/simple-demo-operator-bundle:latest
      ASSET_TYPE: operator
      PFLT_INDEXIMAGE: quay.io/opdev/simple-demo-operator-catalog:latest
      PFLT_ARTIFACTS: "./artifacts"
      PFLT_DOCKERCONFIG: "2D2D2D2D2D424547494E20504750204D4553534147452D2D2D2D2D0A0A6851494D413878694F4D4A634935763641524141672F2B544C787765556A797A67534B704D634E6F65534B6F4A664569555447515A63325A44564B4C503744470A6A465134386746412F3546777449596C34376E52794E796D7562787862346B394B4E5552637658796E36396E4A745375485436685447526261624349527A56420A3332696276344C7A336D63636D3154586D703433474861366F7A6C68644468516A6E614D31756E7845646A5538447939636B44412F31384A57353846554542530A6E4569472F72734668646845656E384344783142796B7348574C6E6F3956696B6867316D4B38436950496A72394346486E503765565174353150726B634543510A316C344D39627878576D44724849726C6C684F4B4A6E6E462B55553434734D53476970317A59736F6B423856536E425A5957384F486A33336C5170535A6572440A5468466D474B774230555651453941413846305A514A705358767A633679334B733864775362597A787536582F6B61523733577A3171536E41456C41776F43370A6A79387361522B73596668557030366C41383944342B3543314573337962565773476D346B467253357675324B4935314E454B63634E3346714F2B455166666E0A2F5530322B574154734366463468733975424D7256704F674A5043444842584F6367794D4862443143746D566E475350346B66656A4B466866316E4F4E3030750A376A43767A6A616568455145442F4B76456C6F77646738714275507A6973716D4D56502F70637A3379304B5961346B6E477947302F34554762477670525766760A473242644D4F4E445A753175457157434E57694B594977576575727A5344563058466D4D5643304571375370666D6B6561706E61645455445875336C753834700A726172354A795969796E57727A745658764C48306C636A514E4B672B466256336238764766683164687874554F4E717A4F73663246714D6943595176763862530A3651466E6E50437376374F49374F7A4F6857356639377A55594E7634454D6D6F524F49517A52333855616F49494230444231442B3668413157584C536C445A660A665A774461672F704F5072662F5666564354626A6C65496765424A396F647A44454B3166495A626A4F39487451464E4C67505A7A6A684C63546E6F6443452B2F0A6B72636B484B497965365A6B324942476D62735671306246706474436B2F326935395A4A3874566C3339377550497A34573347774E50694D667A5778613571610A7A4C372F4D7635747247682B6674477A76345A774D43487238556E3941774A4F365868626348505567706151594D5242494174464A3130487A543735626E2B710A65573154784467306776795A3470616F65486B4D5576616C73373755657068394477754747472F36655177435937307762752B7079326C587867743533692B4F0A62734E7356493964636F64386F6C4570794B4768376C557A507766345933744C5A5533396A322B624746752B734F5543537870326B75634E4C4C30464D5059370A5938536133414330616334786C345042616E6138425464666447377A4941314342334B4C5461756565725A33504644333869307A414A557A674B37305769616C0A4C77544F4E48656F3558485A636F42563131487A515034483568526A5168647967654F4E63796F416F634A693152723635372F6671765367462B7342345965790A4435744E393954356C712B6C797A654D78422F6C7968477756563954753945376D5436446E364D7576643442725059312B766D39442B5971476C4E663343416C0A735869785479365A3437346745595347386956664B325233677A4D76386167487572722B77434845357530376D70337A5868536C685A307571485A4B4F5850540A364155356C623772652B69486C6957614C52555071313244363964346B6B58676963782F726755713877504D77464750746361477A653356303030487A3773460A374375577670447A6C4D6E3775656E5774464B336A796D383655304C41486D41314B4168704B4658313862625346554C52704A7534745933353855355862372B0A685175674E6F7950717470485146454F6F47656A756F337043524A6A4A4C4D72515478575A58346E49742F70524D576B75753379356D36777A557054496674580A384246464C6939302F322F59563441746C627473793179325654785530796571324F677A44486233774C47436E574A55575952345865365075684157376E38330A5932477954684E754E2F4144373436614F572F77576D424C74497352577855305A336F53427961557A6C463574316D3257464A4E626B5248316D48556E31594D0A5438354C473165396172774947463747517A2B417174744655433177742B4945326F4D4E736651794231612F675A6448744C486B4D4D326C386549696D7169520A43566543746E4C69736E716B745A4E4A5A4264774F4C6B314471773D0A3D374347580A2D2D2D2D2D454E4420504750204D4553534147452D2D2D2D2D0A"
    pre:
    - ref: ipi-install-rbac
    test:
    - ref: operator-pipelines-preflight-common-decrypt
    - ref: operator-pipelines-preflight-common-check
    - ref: operator-pipelines-preflight-common-encrypt
    post:
    - chain: gather
  documentation: |-
    This workflows perform shared pre/post actions on clusters obtained from
    preinstalled pools (https://docs.ci.openshift.org/docs/architecture/ci-operator/#testing-with-a-cluster-from-a-cluster-pool).
    Claims a cluster with a default configuration on AWS and executes the Preflight
    tool against a provided asset.
    Important: Parameter values in `env` are supposed to be used only in rehearsals
    and serve as "testing defaults". Production jobs should always override them
    via `preflight-trigger`.
