build_root:
  image_stream_tag:
    name: ci-framework-image
    namespace: openstack-k8s-operators
    tag: latest
images:
- dockerfile_literal: |
    FROM src
    RUN dnf install -y python3.12 python3.12-pip git && \
        (alternatives --install /usr/bin/python3 python3 /usr/bin/python3.12 20 2>/dev/null || true) && \
        (alternatives --set python3 /usr/bin/python3.12 2>/dev/null || \
         ln -sf /usr/bin/python3.12 /usr/bin/python3) && \
        (ln -sf /usr/bin/pip3.12 /usr/bin/pip3 2>/dev/null || python3.12 -m ensurepip --upgrade) && \
        python3.12 -m pip install pre-commit ansi2txt
  from: src
  to: edpm-ansible-pre-commit
resources:
  '*':
    limits:
      memory: 4Gi
    requests:
      cpu: 100m
      memory: 200Mi
tests:
- as: pre-commit-test
  commands: |
    export HOME=/tmp
    export ANSIBLE_LOCAL_TMP=/tmp
    export ANSIBLE_REMOTE_TMP=/tmp
    make -C ../ci-framework pre_commit_nodeps BASEDIR=../edpm-ansible/
  container:
    from: edpm-ansible-pre-commit
  skip_if_only_changed: ^renovate.json|^README.md
zz_generated_metadata:
  branch: main
  org: openstack-k8s-operators
  repo: edpm-ansible
