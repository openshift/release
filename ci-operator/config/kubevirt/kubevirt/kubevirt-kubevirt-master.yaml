base_images:
  base:
    name: "4.2"
    namespace: ocp
    tag: base
build_root:
  project_image:
    context_dir: hack/kubevirt-builder
    dockerfile_path: Dockerfile
resources:
  '*':
    limits:
      memory: 4Gi
    requests:
      cpu: 100m
      memory: 200Mi
tag_specification:
  name: "4.2"
  namespace: ocp
tests:
- as: "kubevirt-e2e-test"
  commands: |
    # we hack the build process as we don't have bazel around here
    # normally we'd only need to use automate/test.sh
    set -e
    set -o pipefail

    # setup go env
    export GIMME_GO_VERSION=1.12.8
    source /etc/profile.d/gimme.sh

    # make generate
    ./hack/dep-update.sh
    ./hack/dep-prune.sh
    ./hack/generate.sh

    # make cluster-sync
    export KUBEVIRT_PROVIDER=external
    ./hack/cluster-build.sh
    ./hack/cluster-deploy.sh

    # make functest
    ./hack/functests.sh
  openshift_installer_src:
    cluster_profile: gcp
