build_root:
  project_image:
    dockerfile_literal: |-
      FROM registry.access.redhat.com/ubi8/python-39

      # Prow expects to be able to check out a repo under /go
      USER 0:0
      WORKDIR /go
      RUN chown 1001:1001 .

      USER 1001:1001
images:
- dockerfile_path: Containerfile
  to: merge-bot
resources:
  '*':
    limits:
      memory: 4Gi
    requests:
      cpu: 100m
      memory: 200Mi
test_binary_build_commands: make install-all-deps
tests:
- as: lint
  commands: make lint
  container:
    from: test-bin
- as: unittests
  commands: make unittests
  container:
    from: test-bin
- as: cluster-api-provider-openstack-main
  cron: 0 12 * * Mon,Thu
  steps:
    test:
    - as: cluster-api-provider-openstack-main
      commands: |
        merge-bot --source https://github.com/kubernetes-sigs/cluster-api-provider-openstack:release-0.9 \
                  --dest openshift/cluster-api-provider-openstack:main \
                  --merge shiftstack/cluster-api-provider-openstack:merge-bot-main \
                  --update-go-modules \
                  --bot-name shiftstack-merge-bot --bot-email shiftstack-merge-bot@redhat.com \
                  --github-app-key /secrets/merge-bot/github_private_key \
                  --github-cloner-key /secrets/merge-bot/github_cloner_private_key \
                  --slack-webhook /secrets/slack-hooks/forum-shiftstack
      credentials:
      - mount_path: /secrets/merge-bot
        name: shiftstack-merge-bot
        namespace: test-credentials
      - mount_path: /secrets/slack-hooks
        name: shiftstack-slack-hooks
        namespace: test-credentials
      from: merge-bot
      resources:
        limits:
          memory: 4Gi
        requests:
          cpu: 100m
          memory: 200Mi
- as: cluster-api-provider-openstack-4-15
  cron: 0 12 * * Mon,Thu
  steps:
    test:
    - as: cluster-api-provider-openstack-4-15
      commands: |
        merge-bot --source https://github.com/kubernetes-sigs/cluster-api-provider-openstack:release-0.8 \
                  --dest openshift/cluster-api-provider-openstack:release-4.15 \
                  --merge shiftstack/cluster-api-provider-openstack:merge-bot-release-4.15 \
                  --update-go-modules \
                  --bot-name shiftstack-merge-bot --bot-email shiftstack-merge-bot@redhat.com \
                  --github-app-key /secrets/merge-bot/github_private_key \
                  --github-cloner-key /secrets/merge-bot/github_cloner_private_key \
                  --slack-webhook /secrets/slack-hooks/forum-shiftstack
      credentials:
      - mount_path: /secrets/merge-bot
        name: shiftstack-merge-bot
        namespace: test-credentials
      - mount_path: /secrets/slack-hooks
        name: shiftstack-slack-hooks
        namespace: test-credentials
      from: merge-bot
      resources:
        limits:
          memory: 4Gi
        requests:
          cpu: 100m
          memory: 200Mi
- as: cloud-provider-openstack-master
  cron: 0 12 * * Mon,Thu
  steps:
    test:
    - as: cloud-provider-openstack-master
      commands: |
        merge-bot --source https://github.com/kubernetes/cloud-provider-openstack:release-1.29 \
                  --dest openshift/cloud-provider-openstack:master \
                  --merge shiftstack/cloud-provider-openstack:merge-bot-master \
                  --update-go-modules \
                  --bot-name shiftstack-merge-bot --bot-email shiftstack-merge-bot@redhat.com \
                  --github-app-key /secrets/merge-bot/github_private_key \
                  --github-cloner-key /secrets/merge-bot/github_cloner_private_key \
                  --slack-webhook /secrets/slack-hooks/forum-shiftstack
      credentials:
      - mount_path: /secrets/merge-bot
        name: shiftstack-merge-bot
        namespace: test-credentials
      - mount_path: /secrets/slack-hooks
        name: shiftstack-slack-hooks
        namespace: test-credentials
      from: merge-bot
      resources:
        limits:
          memory: 4Gi
        requests:
          cpu: 100m
          memory: 200Mi
- as: cloud-provider-openstack-4-15
  cron: 0 12 * * Mon,Thu
  steps:
    test:
    - as: cloud-provider-openstack-4-15
      commands: |
        merge-bot --source https://github.com/kubernetes/cloud-provider-openstack:release-1.28 \
                  --dest openshift/cloud-provider-openstack:release-4.15 \
                  --merge shiftstack/cloud-provider-openstack:merge-bot-release-4.15 \
                  --update-go-modules \
                  --bot-name shiftstack-merge-bot --bot-email shiftstack-merge-bot@redhat.com \
                  --github-app-key /secrets/merge-bot/github_private_key \
                  --github-cloner-key /secrets/merge-bot/github_cloner_private_key \
                  --slack-webhook /secrets/slack-hooks/forum-shiftstack
      credentials:
      - mount_path: /secrets/merge-bot
        name: shiftstack-merge-bot
        namespace: test-credentials
      - mount_path: /secrets/slack-hooks
        name: shiftstack-slack-hooks
        namespace: test-credentials
      from: merge-bot
      resources:
        limits:
          memory: 4Gi
        requests:
          cpu: 100m
          memory: 200Mi
- as: cloud-provider-openstack-4-14
  cron: 0 12 * * Mon,Thu
  steps:
    test:
    - as: cloud-provider-openstack-4-14
      commands: |
        merge-bot --source https://github.com/kubernetes/cloud-provider-openstack:release-1.27 \
                  --dest openshift/cloud-provider-openstack:release-4.14 \
                  --merge shiftstack/cloud-provider-openstack:merge-bot-release-4.14 \
                  --update-go-modules \
                  --bot-name shiftstack-merge-bot --bot-email shiftstack-merge-bot@redhat.com \
                  --github-app-key /secrets/merge-bot/github_private_key \
                  --github-cloner-key /secrets/merge-bot/github_cloner_private_key \
                  --slack-webhook /secrets/slack-hooks/forum-shiftstack
      credentials:
      - mount_path: /secrets/merge-bot
        name: shiftstack-merge-bot
        namespace: test-credentials
      - mount_path: /secrets/slack-hooks
        name: shiftstack-slack-hooks
        namespace: test-credentials
      from: merge-bot
      resources:
        limits:
          memory: 4Gi
        requests:
          cpu: 100m
          memory: 200Mi
- as: cloud-provider-openstack-4-13
  cron: 0 12 * * Mon,Thu
  steps:
    test:
    - as: cloud-provider-openstack-4-13
      commands: |
        merge-bot --source https://github.com/kubernetes/cloud-provider-openstack:release-1.26 \
                  --dest openshift/cloud-provider-openstack:release-4.13 \
                  --merge shiftstack/cloud-provider-openstack:merge-bot-release-4.13 \
                  --update-go-modules \
                  --bot-name shiftstack-merge-bot --bot-email shiftstack-merge-bot@redhat.com \
                  --github-app-key /secrets/merge-bot/github_private_key \
                  --github-cloner-key /secrets/merge-bot/github_cloner_private_key \
                  --slack-webhook /secrets/slack-hooks/forum-shiftstack
      credentials:
      - mount_path: /secrets/merge-bot
        name: shiftstack-merge-bot
        namespace: test-credentials
      - mount_path: /secrets/slack-hooks
        name: shiftstack-slack-hooks
        namespace: test-credentials
      from: merge-bot
      resources:
        limits:
          memory: 4Gi
        requests:
          cpu: 100m
          memory: 200Mi
- as: cloud-provider-openstack-4-12
  cron: 0 12 * * Mon,Thu
  steps:
    test:
    - as: cloud-provider-openstack-4-12
      commands: |
        merge-bot --source https://github.com/kubernetes/cloud-provider-openstack:release-1.25 \
                  --dest openshift/cloud-provider-openstack:release-4.12 \
                  --merge shiftstack/cloud-provider-openstack:merge-bot-release-4.12 \
                  --update-go-modules \
                  --bot-name shiftstack-merge-bot --bot-email shiftstack-merge-bot@redhat.com \
                  --github-app-key /secrets/merge-bot/github_private_key \
                  --github-cloner-key /secrets/merge-bot/github_cloner_private_key \
                  --slack-webhook /secrets/slack-hooks/forum-shiftstack
      credentials:
      - mount_path: /secrets/merge-bot
        name: shiftstack-merge-bot
        namespace: test-credentials
      - mount_path: /secrets/slack-hooks
        name: shiftstack-slack-hooks
        namespace: test-credentials
      from: merge-bot
      resources:
        limits:
          memory: 4Gi
        requests:
          cpu: 100m
          memory: 200Mi
- as: csi-driver-nfs-master
  cron: 0 12 * * Mon,Thu
  steps:
    test:
    - as: csi-driver-nfs-master
      commands: |
        merge-bot --source https://github.com/kubernetes-csi/csi-driver-nfs:master \
                  --dest openshift/csi-driver-nfs:master \
                  --merge shiftstack/csi-driver-nfs:merge-bot-master \
                  --update-go-modules \
                  --bot-name shiftstack-merge-bot --bot-email shiftstack-merge-bot@redhat.com \
                  --github-app-key /secrets/merge-bot/github_private_key \
                  --github-cloner-key /secrets/merge-bot/github_cloner_private_key \
                  --slack-webhook /secrets/slack-hooks/forum-shiftstack
      credentials:
      - mount_path: /secrets/merge-bot
        name: shiftstack-merge-bot
        namespace: test-credentials
      - mount_path: /secrets/slack-hooks
        name: shiftstack-slack-hooks
        namespace: test-credentials
      from: merge-bot
      resources:
        limits:
          memory: 4Gi
        requests:
          cpu: 100m
          memory: 200Mi
zz_generated_metadata:
  branch: main
  org: shiftstack
  repo: merge-bot
