base_images:
  cli:
    name: "4.13"
    namespace: ocp
    tag: cli
build_root:
  image_stream_tag:
    name: release
    namespace: openshift
    tag: golang-1.17
images:
- inputs:
    src:
      as:
      - quay.io/rh_integration/strimzi-interop
  to: src-test
releases:
  latest:
    candidate:
      product: ocp
      stream: nightly
      version: "4.13"
resources:
  '*':
    limits:
      memory: 4Gi
    requests:
      cpu: 100m
      memory: 200Mi
tests:
- as: smoke-tests
  cron: 0 0 1 1 *
  steps:
    cluster_profile: aws-cspi-qe
    env:
      SUB_CHANNEL: stable
      SUB_INSTALL_NAMESPACE: openshift-streams
      SUB_PACKAGE: amq-streams
      SUB_SOURCE: redhat-operators
      SUB_TARGET_NAMESPACES: openshift-streams
    test:
    - ref: operatorhub-subscribe
    - as: test
      commands: |
        export USER_NAME=kubeadmin
        export PASSWORD=`cat ${KUBEADMIN_PASSWORD_FILE}`
        export API_URL=`oc whoami --show-server`
        export NAMESPACE=openshift-streams
        export KUBECONFIG="${SHARED_DIR}/kubeconfig"
        /bin/bash -c "make interop && cp -r tests/target/surefire-reports/$TESTS_OUTPUT && oc delete -f scenario -n $NAMESPACE"
      from: strimzi-interop
      resources:
        requests:
          cpu: 100m
