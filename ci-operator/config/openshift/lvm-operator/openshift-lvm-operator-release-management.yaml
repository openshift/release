base_images:
  ocp_4.21_cli:
    name: "4.21"
    namespace: ocp
    tag: cli
build_root:
  image_stream_tag:
    name: builder
    namespace: ocp
    tag: rhel-9-golang-1.24-openshift-4.21
images:
- dockerfile_literal: |-
    FROM ocp_cli
    RUN dnf install -y jq
  from: ocp_4.21_cli
  to: lvms-releaser
resources:
  '*':
    limits:
      memory: 4Gi
    requests:
      cpu: 100m
      memory: 200Mi
tests:
- as: release-dry-run
  commands: |
    export KONFLUX_SA_TOKEN=$(cat /tmp/secret/sa-token)
    export KONFLUX_SERVER=$(cat /tmp/secret/server)
    export KONFLUX_NAMESPACE=$(cat /tmp/secret/namespace)
    export DRYRUNONLY="true"
    ./hack/manage-release.sh
  container:
    clone: true
    from: lvms-releaser
  run_if_changed: releases/*.yaml
  secret:
    mount_path: /tmp/secret
    name: lvms-konflux-bot-creds
- as: release
  commands: |
    export KONFLUX_SA_TOKEN=$(cat /tmp/secret/sa-token)
    export KONFLUX_SERVER=$(cat /tmp/secret/server)
    export KONFLUX_NAMESPACE=$(cat /tmp/secret/namespace)
    ./hack/manage-release.sh
  container:
    clone: true
    from: lvms-releaser
  run_if_changed: releases/*.yaml
  secret:
    mount_path: /tmp/secret
    name: lvms-konflux-bot-creds
zz_generated_metadata:
  branch: release-management
  org: openshift
  repo: lvm-operator
