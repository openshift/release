base_images:
  coreos_coreos-assembler_latest:
    name: coreos-assembler
    namespace: coreos
    tag: latest
build_root:
  image_stream_tag:
    name: fcos-buildroot
    namespace: coreos
    tag: testing-devel
images:
- dockerfile_path: ci/Dockerfile
  inputs:
    coreos_coreos-assembler_latest:
      as:
      - registry.svc.ci.openshift.org/coreos/coreos-assembler:latest
  to: build-test-qemu-img
promotion:
  excluded_images:
  - '*'
  name: "4.11"
  namespace: ocp
raw_steps:
- pipeline_image_cache_step:
    commands: |
      mkdir -p /image
      skopeo copy docker://registry.fedoraproject.org/fedora:latest oci-archive:/image/fedora.oci
    from: build-test-qemu-img
    to: skopeo-pull
- project_directory_image_build_step:
    dockerfile_literal: |
      FROM oci-archive:fedora.oci
      LABEL built
    inputs:
      skopeo-pull:
        paths:
        - destination_dir: .
          source_path: /image/fedora.oci
    to: final-content
- output_image_tag_step:
    from: final-content
    optional: false
    to:
      name: stable
      namespace: ""
      tag: final-content
releases:
  initial:
    integration:
      name: "4.11"
      namespace: ocp
  latest:
    integration:
      include_built_images: true
      name: "4.11"
      namespace: ocp
resources:
  '*':
    requests:
      cpu: 1000m
      memory: 1Gi
  build-test-qemu:
    limits:
      devices.kubevirt.io/kvm: "1"
    requests:
      cpu: 1000m
      devices.kubevirt.io/kvm: "1"
      memory: 3Gi
tests:
- as: validate
  commands: ./ci/validate.sh
  container:
    from: src
  skip_if_only_changed: ^docs/|\.md$|^(?:.*/)?(?:\.gitignore|OWNERS|PROJECT|LICENSE)$
- as: build-test-qemu
  commands: /src/ci/build-test-qemu.sh
  container:
    from: build-test-qemu-img
  skip_if_only_changed: ^docs/|\.md$|^(?:.*/)?(?:\.gitignore|OWNERS|PROJECT|LICENSE)$
- as: final-content-test
  commands: cat /etc/os-release
  container:
    from: final-content
  skip_if_only_changed: ^docs/|\.md$|^(?:.*/)?(?:\.gitignore|OWNERS|PROJECT|LICENSE)$
zz_generated_metadata:
  branch: master
  org: openshift
  repo: os
