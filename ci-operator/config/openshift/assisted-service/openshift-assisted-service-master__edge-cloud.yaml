releases:
  latest:
    integration:
      name: "4.10"
      namespace: ocp
resources:
  '*':
    requests:
      cpu: 100m
      memory: 200Mi
tests:
- as: subsystem
  cluster_claim:
    architecture: amd64
    cloud: aws
    owner: openshift-ci
    product: ocp
    timeout: 1h0m0s
    version: "4.10"
  run_if_changed: ^(cmd/.*|deploy/.*|hack/.*|internal/.*|pkg/.*|tools/.*|subsystem/.*|Dockerfile\..*|Makefile|go\.mod|go\.sum|swagger.yaml)$
  steps:
    allow_best_effort_post_steps: true
    test:
    - as: subsystem-deploy-and-run
      cli: latest
      commands: |
        export BUILD_TYPE=CI
        export REPORTS=${ARTIFACT_DIR}
        export TARGET=oc

        make deploy-on-openshift-ci
        make test
      dependencies:
      - env: SERVICE
        name: assisted-service
      from: test-bin
      resources:
        requests:
          cpu: 100m
          memory: 200Mi
    workflow: generic-claim
- as: e2e-metal-assisted
  run_if_changed: ^(cmd/.*|data/.*|deploy/.*|hack/.*|internal/.*|pkg/.*|tools/.*|Dockerfile\..*|Makefile|go\.mod|go\.sum|swagger.yaml)$
  steps:
    cluster_profile: packet-assisted
    workflow: assisted-baremetal
- as: e2e-metal-assisted-onprem
  optional: true
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        DEPLOY_TARGET=onprem
    workflow: assisted-baremetal
- as: e2e-metal-assisted-tpmv2
  optional: true
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        DISK_ENCRYPTION_ROLES=all
        DISK_ENCRYPTION_MODE=tpmv2
    workflow: assisted-baremetal
- as: e2e-metal-assisted-tang
  optional: true
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        DISK_ENCRYPTION_ROLES=all
        DISK_ENCRYPTION_MODE=tang
    workflow: assisted-baremetal
- as: e2e-metal-assisted-4-8
  optional: true
  run_if_changed: ^(data/.*)$
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        OPENSHIFT_VERSION=4.8
    workflow: assisted-baremetal
- as: e2e-metal-assisted-4-9
  optional: true
  run_if_changed: ^(data/.*)$
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        OPENSHIFT_VERSION=4.9
    workflow: assisted-baremetal
- as: e2e-metal-assisted-4-10
  optional: true
  run_if_changed: ^(data/.*)$
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        OPENSHIFT_VERSION=4.10
    workflow: assisted-baremetal
- as: e2e-metal-assisted-4-11
  optional: true
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        OPENSHIFT_VERSION=4.11
    workflow: assisted-baremetal
- as: e2e-metal-assisted-cnv
  optional: true
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        OLM_OPERATORS=cnv
    workflow: assisted-baremetal
- as: e2e-metal-assisted-odf
  optional: true
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        OLM_OPERATORS=odf
    workflow: assisted-baremetal
- as: e2e-metal-assisted-ocs
  optional: true
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        OLM_OPERATORS=ocs
        OPENSHIFT_VERSION=4.8
    workflow: assisted-baremetal
- as: e2e-metal-assisted-ipxe
  optional: true
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        IPXE_BOOT=true
    workflow: assisted-baremetal
- as: e2e-metal-assisted-day2
  optional: true
  run_if_changed: ^(data/.*)$
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        TEST_FUNC=test_deploy_day2_nodes_cloud
    workflow: assisted-baremetal
- as: e2e-metal-assisted-ipv6
  optional: true
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        IPv6=yes
        IPv4=no
    workflow: assisted-baremetal
- as: e2e-metal-assisted-ipv4v6
  optional: true
  run_if_changed: ^(data/.*)$
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        IPv6=yes
        IPv4=yes
    workflow: assisted-baremetal
- as: e2e-metal-assisted-static-ip-suite
  optional: true
  run_if_changed: ^(data/.*)$
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        STATIC_IPS=true
        TEST_FUNC=test_networking
    workflow: assisted-baremetal
- as: e2e-metal-assisted-none
  optional: true
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        PLATFORM=none
    workflow: assisted-baremetal
- as: e2e-metal-assisted-single-node
  optional: true
  run_if_changed: ^(data/.*)$
  steps:
    cluster_profile: packet-assisted
    env:
      ASSISTED_CONFIG: |
        NUM_MASTERS=1
    workflow: assisted-baremetal
zz_generated_metadata:
  branch: master
  org: openshift
  repo: assisted-service
  variant: edge-cloud
