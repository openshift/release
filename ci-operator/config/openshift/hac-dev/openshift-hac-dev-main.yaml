binary_build_commands: ./build.sh
build_root:
  image_stream_tag:
    name: release
    namespace: openshift
    tag: tectonic-console-builder-v23
images:
  - dockerfile_path: "integration-tests/Dockerfile"
    from: src
    to: cypress-runner
promotion:
  name: hac-dev
  namespace: ci
resources:
  '*':
    limits:
      memory: 4Gi
    requests:
      cpu: 100m
      memory: 200Mi
tests:
- as: test
  commands: |
    echo "Just trying"
    pwd
    ls -la
    npm version

    echo "Installing bonfire."
    VENV_DIR=$(mktemp -d)
    python3 -m venv "$VENV_DIR"
    . "$VENV_DIR"/bin/activate
    pip install crc-bonfire
    echo "Reserving namespace."
    NAMESPACE=$(bonfire namespace reserve -f)
  container:
    from: cypress-runner
# - as: test
#   commands: "export CODECOV_TOKEN=$(cat /tmp/secret/CODECOV_TOKEN) \n./test.sh\n"
#   container:
#     from: src
#   secret:
#     mount_path: /tmp/secret
#     name: hac-dev-codecov-token
# - as: test-coverage-upload
#   commands: "export CODECOV_TOKEN=$(cat /tmp/secret/CODECOV_TOKEN) \n./test.sh\n"
#   container:
#     from: src
#   postsubmit: true
#   secret:
#     mount_path: /tmp/secret
#     name: hac-dev-codecov-token
zz_generated_metadata:
  branch: main
  org: openshift
  repo: hac-dev
