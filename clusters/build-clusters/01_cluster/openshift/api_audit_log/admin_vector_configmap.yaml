kind: ConfigMap
apiVersion: v1
data:
  vector.toml: |-
    [sources.kube_apiserver_audit_logs]
      type = "file"
      include = ["/host/var/log/kube-apiserver/audit.log"]
      ignore_older = 86400

    [sources.openshift_apiserver_audit_logs]
      type = "file"
      include = ["/host/var/log/openshift-apiserver/audit.log"]
      ignore_older = 86400
    #For debug only, will switch to https://vector.dev/docs/reference/sinks/aws_cloudwatch_logs/
    #when debugging is done
    [sinks.console]
      type = "console"
      inputs = ["kube_apiserver_audit_logs", "openshift_apiserver_audit_logs"]
      encoding = "json"
metadata:
  name: vector-audit-log-config
  namespace: api-audit-log

